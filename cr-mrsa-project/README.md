# Mini RSA Project (cr-mrsa-project)

64λΉ„νΈ Mini RSA μ•κ³ λ¦¬μ¦μ„ C μ–Έμ–΄λ΅ κµ¬ν„ν• μ•”νΈν•™ ν”„λ΅μ νΈμ…λ‹λ‹¤.  
μ‹¤μ  RSA(2048bit)λ³΄λ‹¤ μ‘μ€ λ²„μ „μ΄μ§€λ§,  
**ν‚¤ μƒμ„± β†’ μ•”νΈν™” β†’ λ³µνΈν™”**μ νλ¦„ μ „μ²΄λ¥Ό μ§μ ‘ κµ¬ν„ν•μ—¬  
RSA μ•κ³ λ¦¬μ¦μ λ™μ‘ μ›λ¦¬λ¥Ό μ΄ν•΄ν•λ” λ° μ΄μ μ„ λ§μ¶ ν”„λ΅μ νΈμ…λ‹λ‹¤.

---

## π”‘ ν”„λ΅μ νΈ λ©ν‘

- 64λΉ„νΈ RSA λ¨λ“λ¬μ¤ \(2^{63} β‰¤ n < 2^{64}\) μƒμ„±  
- Carmichael ν•¨μ Ξ»(n)μ„ μ΄μ©ν•΄ κ³µκ°ν‚¤Β·κ°μΈν‚¤ μƒμ„±  
- Millerβ€“Rabin μ†μ νλ³„λ΅ 32bit μ†μ p, q μƒμ„±  
- `m^k mod n` λ°©μ‹μ μ•”Β·λ³µνΈν™” κµ¬ν„  

μ‚¬μ©μκ°€ μ‹¤μ  νΈμ¶ν•λ” μΈν„°νμ΄μ¤λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

```c
void mRSA_generate_key(uint64_t *e, uint64_t *d, uint64_t *n);
int  mRSA_cipher(uint64_t *m, uint64_t k, uint64_t n);
```

---

## π§ μ£Όμ” ν•¨μ μ½”λ“ & κµ¬ν„ κ³Όμ • μ”μ•½

Mini RSA κµ¬ν„μ—μ„ ν•µμ‹¬μ΄ λλ” μ£Όμ” ν•¨μλ“¤μ„ μ•„λμ™€ κ°™μ΄ μ”μ•½ν–μµλ‹λ‹¤.  
κ° ν•¨μλ” RSA κµ¬μ΅°λ¥Ό μλ΅ μ  λ°©μ‹μΌλ΅ Cμ— μ§μ ‘ κµ¬ν„ν• κ²ƒμ…λ‹λ‹¤.

---

### π”Ή 1. λ¨λ“λ¬ κ±°λ“­μ κ³± (`mod_pow`)

RSAμ **m^k mod n** μ—°μ‚°μ„ ν¨μ¨μ μΌλ΅ μν–‰ν•κΈ° μ„ν• ν•µμ‹¬ ν•¨μλ΅,  
λΉ λ¥Έ κ±°λ“­μ κ³± μ•κ³ λ¦¬μ¦(Exponentiation by Squaring)μ„ μ‚¬μ©ν–μµλ‹λ‹¤.

```c
static uint64_t mod_pow(uint64_t base, uint64_t exp, uint64_t mod)
{
    uint64_t result = 1;

    while (exp > 0) {
        if (exp & 1)
            result = mod_mul(result, base, mod);

        base = mod_mul(base, base, mod);
        exp >>= 1;
    }
    return result;
}
```

**κµ¬ν„ ν¬μΈνΈ**  
- μ‹κ°„ λ³µμ΅λ„ O(log k)  
- μ¤λ²„ν”λ΅ λ°©μ§€ μ„ν•΄ mod_mul μ‚¬μ©  
- RSA μ•”Β·λ³µνΈν™”μ— μ§μ ‘ μ‚¬μ©λλ” ν•µμ‹¬ μ—°μ‚°  

---

### π”Ή 2. ν‚¤ μƒμ„± (`mRSA_generate_key`)

λ‘ κ°μ 32bit μ†μλ¥Ό κΈ°λ°μΌλ΅ **64bit λ¨λ“λ¬μ¤ n**μ„ λ§λ“¤κ³ ,  
Carmichael Ξ»(n)μ„ μ‚¬μ©ν•μ—¬ (e, d) ν‚¤ μμ„ μƒμ„±ν•©λ‹λ‹¤.

```c
void mRSA_generate_key(uint64_t *e, uint64_t *d, uint64_t *n)
{
    uint64_t p, q, lambda;

    generate_prime(&p);
    generate_prime(&q);

    *n = p * q;

    lambda = lcm(p - 1, q - 1);

    *e = 65537;

    *d = umul_inv(*e, lambda);
}
```

**κµ¬ν„ ν¬μΈνΈ**  
- Millerβ€“Rabin κΈ°λ° generate_prime() μ‚¬μ©  
- nμ΄ \(2^{63}\) μ΄μƒμ΄ λ  λ•κΉμ§€ λ°λ³µ  
- e=65537 (RSA ν‘μ¤€ κ°’)  
- dλ” ν™•μ¥ μ ν΄λ¦¬λ“ μ•κ³ λ¦¬μ¦ κΈ°λ° μ—­μ› κ³„μ‚°  

---

### π”Ή 3. μ•”Β·λ³µνΈν™” (`mRSA_cipher`)

RSAλ” λ™μΌν• ν•¨μλ΅ μ•”νΈν™”μ™€ λ³µνΈν™”λ¥Ό μν–‰ν•©λ‹λ‹¤.  
(k = e β†’ μ•”νΈν™”, k = d β†’ λ³µνΈν™”)

```c
int mRSA_cipher(uint64_t *m, uint64_t k, uint64_t n)
{
    if (!m || n < 2)
        return 1;

    if (*m >= n)
        *m %= n;

    *m = mod_pow(*m, k, n);
    return 0;
}
```

**κµ¬ν„ ν¬μΈνΈ**  
- mμ„ Zβ‚™ λ²”μ„λ΅ μ΅°μ •  
- λ¨λ“λ¬ κ±°λ“­μ κ³±μ„ ν†µν• μ•”Β·λ³µνΈν™” μ²λ¦¬  
- ν•λ‚μ κ³µν†µ ν•¨μλ΅ λ™μ‘  

---

## π“ κµ¬ν„ κ³Όμ • μ”μ•½

- **32bit μ†μ μƒμ„±**  
  - Millerβ€“Rabin κ²°μ •μ  ν…μ¤νΈ(12κ° κΈ°μ €)  
  - arc4random κΈ°λ° λ‚μ μ‚¬μ©
- **64bit λ¨λ“λ¬μ¤ μƒμ„±**  
  - μ΅°κ±΄: \(2^{63} β‰¤ n < 2^{64}\)  
  - μ΅°κ±΄ λ¶λ§μ΅± μ‹ μƒ μ†μ μ¬μƒμ„±
- **Carmichael Ξ»(n)**  
  - RSA κµ¬μ΅°μ ν•µμ‹¬  
  - κ³µκ°ν‚¤ e, κ°μΈν‚¤ dμ κ΄€κ³„λ¥Ό κ²°μ •
- **μ•”Β·λ³µνΈν™” κµ¬ν„**  
  - λΉ λ¥Έ λ¨λ“λ¬ κ±°λ“­μ κ³±(mod_pow) μ‚¬μ©  
  - mRSA_cipher ν•λ‚λ΅ μ•”Β·λ³µνΈν™” μ²λ¦¬
- **Random Testing 100% PASS**  
  - n λ²”μ„ / μ†μμ„± / λ¨λ“λ¬ μ—°μ‚° κ²€μ¦ μ™„λ£

---

## π§© ν•µμ‹¬ κΈ°λ¥ μ”μ•½ ν‘

| κΈ°λ¥ | μ„¤λ… |
|------|------|
| **ν‚¤ μƒμ„±** | 32λΉ„νΈ μ†μ p, q μƒμ„± β†’ n = pΒ·q κµ¬μ„± |
| **Carmichael ν•¨μ** | Ξ»(n) = lcm(pβ’1, qβ’1) κΈ°λ°μΌλ΅ e, d κ³„μ‚° |
| **λ¨λ“λ¬ μ—°μ‚°** | mod_add, mod_mul, mod_pow, gcd, umul_inv κµ¬ν„ |
| **μ†μ νλ³„** | 64bit Millerβ€“Rabin ν…μ¤νΈ |
| **μ•”Β·λ³µνΈν™”** | mRSA_cipher()λ΅ m^k mod n μν–‰ |
| **λλ¤ ν…μ¤νΈ** | ν…μ¤νΈ μ½”λ“ κΈ°μ¤€ PASS |

---

## π›  μ‚¬μ© κΈ°μ  μ¤νƒ

- **μ–Έμ–΄:** C (C99)
- **λ‚μ:** arc4random, arc4random_uniform  
- **μλ΅  μ•κ³ λ¦¬μ¦:**  
  - μ ν΄λ¦¬λ“ νΈμ λ²•  
  - ν™•μ¥ μ ν΄λ¦¬λ“ μ•κ³ λ¦¬μ¦  
  - λ¨λ“λ¬ κ±°λ“­μ κ³±  
  - λ¨λ“λ¬ μ—­μ› κ³„μ‚°  
- **ν™κ²½:** Linux / macOS / WSL (POSIX κΈ°λ°)

---

## π“ ν΄λ” κµ¬μ΅°

```plaintext
cr-mrsa-project/
β”β”€β”€ src/
β”‚   β”β”€β”€ mRSA.c
β”‚   β””β”€β”€ test.c
β”β”€β”€ include/
β”‚   β””β”€β”€ mRSA.h
β”β”€β”€ result/
β”‚   β”β”€β”€ expected_result.txt
β”‚   β””β”€β”€ my_result.txt
β”β”€β”€ Makefile
β””β”€β”€ README.md
```

---

## β™οΈ λΉλ“ & μ‹¤ν–‰

```bash
# λΉλ“
make

# μ‹¤ν–‰
./mRSA
```

μ‹¤ν–‰ κ²°κ³Όλ” λ‹¤μ νμΌμ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤:

```
result/my_result.txt
```

μ—¬κΈ°μ—λ” μƒμ„±λ ν‚¤(e, d, n)μ™€  
μ—¬λ¬ λ©”μ‹μ§€ mμ— λ€ν• μ•”Β·λ³µνΈν™” κ²°κ³Όκ°€ ν¬ν•¨λ©λ‹λ‹¤.

---

## π“ ν”„λ΅μ νΈ μμ

μ΄ ν”„λ΅μ νΈλ”  
**μ•”νΈν•™μ  μ‚¬κ³ λ ¥ + μ‹μ¤ν… ν”„λ΅κ·Έλλ° λ¥λ ¥ + μλ΅  μ•κ³ λ¦¬μ¦ κµ¬ν„ λ¥λ ¥**μ„  
μ™„μ „ν λ³΄μ—¬μ¤„ μ μλ” Mini RSA κµ¬ν„ ν”„λ΅μ νΈμ…λ‹λ‹¤.

ν¬νΈν΄λ¦¬μ¤λ΅ μ μ¶ν•κΈ°μ— μ ν•©ν• κµ¬μ΅°λ¥Ό κ°–μ¶”κ³  μμµλ‹λ‹¤.
